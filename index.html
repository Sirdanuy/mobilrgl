<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Copeville</title>
    <link rel="shortcut icon" href="TemplateData/mainlogo.jpg">

    <!-- Mobile-first -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

    <style>
      html, body {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
        background: #000;
        font-family: Arial, sans-serif;
        touch-action: none;
        -webkit-tap-highlight-color: transparent;
      }

      #unity-container {
        position: fixed;
        inset: 0;
        width: 100vw;
        height: 100vh;
        background: #000;
      }

      #unity-canvas {
        width: 100%;
        height: 100%;
        display: block;
      }

      #custom-spinner {
        position: absolute;
        top: 50%;
        left: 50%;
        width: 60px;
        height: 60px;
        border: 6px solid rgba(255,255,255,0.2);
        border-top-color: #00ffff;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        transform: translate(-50%, -50%);
        z-index: 10;
      }
      #progress-text {
        position: absolute;
        top: calc(50% + 50px);
        left: 50%;
        transform: translateX(-50%);
        color: #fff;
        font-size: 18px;
        z-index: 11;
      }
      @keyframes spin {
        0% { transform: translate(-50%, -50%) rotate(0deg); }
        100% { transform: translate(-50%, -50%) rotate(360deg); }
      }

      #unity-warning {
        z-index: 20;
        color: white;
        position: absolute;
        bottom: 10px;
        left: 10px;
        font-size: 12px;
      }

      #unity-footer {
        position: absolute;
        bottom: 10px;
        right: 10px;
        color: white;
        z-index: 12;
      }
      #unity-fullscreen-button { cursor: pointer; }

      /* Desktop overlay block */
      #desktop-block, #portrait-block {
        position: fixed;
        inset: 0;
        background: #000;
        color: #fff;
        display: none;
        align-items: center;
        justify-content: center;
        text-align: center;
        padding: 24px;
        z-index: 1000;
      }
      .box {
        max-width: 560px;
        width: 90%;
        border: 1px solid rgba(255,255,255,0.2);
        padding: 20px;
        border-radius: 16px;
        background: rgba(255,255,255,0.04);
        backdrop-filter: blur(6px);
      }
      h1 { margin-bottom: 8px; }
      p { margin: 0; opacity: 0.9; }

      /* Hide entire game if not in landscape */
      @media (orientation: portrait) {
        body.mobile #portrait-block { display: flex; }
        body.mobile #unity-container { display: none; }
      }
      body.desktop #desktop-block { display: flex; }
      body.desktop #unity-container { display: none; }
    </style>

  </head>
  <body>

    <!-- Desktop Block -->
    <div id="desktop-block">
      <div class="box">
        <h1>Mobile Only</h1>
        <p>Please open Copeville on your mobile phone.</p>
      </div>
    </div>

    <!-- Portrait Block -->
    <div id="portrait-block">
      <div class="box">
        <h1>Rotate Your Device</h1>
        <p>Please rotate to landscape to play Copeville.</p>
      </div>
    </div>

    <div id="unity-container">
      <canvas id="unity-canvas"></canvas>
      <div id="custom-spinner"></div>
      <div id="progress-text">0%</div>
      <div id="unity-warning"></div>
      <div id="unity-footer">
        <div id="unity-fullscreen-button">ðŸ”³ Fullscreen</div>
        <div>Copeville</div>
      </div>
    </div>

    <script>
      const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
      document.body.classList.add(isMobile ? 'mobile' : 'desktop');

      if (!isMobile) throw new Error("Mobile only mode.");

      const canvas = document.querySelector("#unity-canvas");
      const spinner = document.querySelector("#custom-spinner");
      const progressText = document.querySelector("#progress-text");

      const loaderUrl = "https://danny.b-cdn.net/Build/mobile.loader.js";
      const config = {
        dataUrl: "https://danny.b-cdn.net/Build/mobile.data",
        frameworkUrl: "https://danny.b-cdn.net/Build/mobile.framework.js",
        codeUrl: "https://danny.b-cdn.net/Build/mobile.wasm",
        streamingAssetsUrl: "https://danny.b-cdn.net/StreamingAssets",
        companyName: "Copeville Development Team",
        productName: "Copeville",
        productVersion: "1.9.3",
        devicePixelRatio: 1,
        matchWebGLToCanvasSize: true,
        webglContextAttributes: {
          antialias: false,
          alpha: false,
          powerPreference: "high-performance",
          preserveDrawingBuffer: false
        }
      };

      const script = document.createElement("script");
      script.src = loaderUrl;
      script.onload = () => {
        createUnityInstance(canvas, config, (progress) => {
          spinner.style.display = "block";
          progressText.textContent = Math.round(progress * 100) + "%";
        }).then((unityInstance) => {
          spinner.style.display = "none";
          progressText.style.display = "none";
          document.querySelector("#unity-fullscreen-button").onclick = () => {
            unityInstance.SetFullscreen(1);
          };
        }).catch((message) =>
          alert(message)
        );
      };
      document.body.appendChild(script);
    </script>

  </body>
</html>
